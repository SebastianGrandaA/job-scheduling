\section{Modélisation} \label{sec:modelisation}

\subsection{Description du problème}

\subsubsection{Ensembles}
\begin{itemize}
    \item \(\mathcal{P} \in \{1, \dots, |\mathcal{P}|\}\): périodes discrètes de temps de l'horizon de planification.
    \item \(\mathcal{K}\): sites possibles pour l'installation des machines.
    \item \(\mathcal{M}\): machines à installer, où \(|\mathcal{M}| \leq |\mathcal{K}|\).
    \item \(\mathcal{J}\): tâches à exécuter et à ordonnancer.
    \item \(\Lambda = \{\lambda_{1}, \lambda_{2}, \lambda_{3}\}\): poids d'installation des machines, de transport des tâches, et des retards, respectivement.
    \item \(\Omega_{k} = \{(j, j') \in \mathcal{J} \times \mathcal{J} : j \neq j'\}\): paires de tâches qui peuvent être exécutées sur la machine \(k \in \mathcal{K}\) pendant l'horizon de planification.
\end{itemize}

\subsubsection{Paramètres}
\begin{itemize}
    \item \(c_{k}\): coût d'installation d'une machine sur le site \(k \in \mathcal{K}\).
    \item \(p_{j}\): durée de la tâche \(j \in \mathcal{J}\) (nombre entier de périodes de temps).
    \item \(d_{j}\): date d'échéance de la tâche \(j \in \mathcal{J}\).
    \item \(f_{jk}\): coût de transport (\( \text{euros/km}\)) de la tâche \(j \in \mathcal{J}\) vers le site \(k \in \mathcal{K}\).
    \item \(d_{jk}\): distance (en km) entre la localisation de la tâche \(j \in \mathcal{J}\) au début de l'horizon de planification et le site \(k \in \mathcal{K}\).
    \item \(u_{jk}\): vitesse de transport (\(\text{km/période de temps}\)) de la tâche \(j \in \mathcal{J}\) vers le site \(k \in \mathcal{K}\).
    \item \(r_{jk} = \frac{d_{jk}}{u_{jk}}\): temps de transport de la tâche \(j \in \mathcal{J}\) vers le site \(k \in \mathcal{K}\), en fonction de la distance \(d_{jk}\).
    \item \(e_{jk} = d_{jk} f_{jk}\): coût de transport de la tâche \(j \in \mathcal{J}\) vers le site \(k \in \mathcal{K}\), en fonction de la distance \(d_{jk}\).
    \item \(\beta\): pénalité pour chaque unité de retard.
\end{itemize}

\subsubsection{Hypothèses}
\begin{itemize}
    \item Toutes les machines \(m \in \mathcal{M}\) sont identiques.
    \item Chaque site \(k \in \mathcal{K}\) peut accueillir au plus une machine \(m \in \mathcal{M}\) au coût d'installation \(c_{k}\).
    \item Chaque machine \(m \in \mathcal{M}\) peut exécuter au plus une tâche \(j \in \mathcal{J}\) à la fois, sans préemption.
    \item Toutes les tâches sont positionnées au début de l'horizon de planification dans une certaine localisation.
    \item Quand une tâche \(j \in \mathcal{J}\) est terminée, elle doit être transportée vers sa localisation d'origine en respectant sa date d'échéance \(d_{j}\).
    \item Si une tâche est de retour à une date \(t > d_{j}\), alors cela entraîne un coût de retard égal à \(t - d_{j}\).
    \item Toutes les tâches sont livrées sur le site désigné au début de l'horizon de planification, et les ressources de transport sont illimitées.
    \item La distance entre chaque paire de coordonnées est euclidienne.
\end{itemize}

---

\subsection{Modèle avec variables indicées sur les périodes}

\subsubsection{Variables de décision}
\begin{itemize}
    \item \(x_{k} \in \{0, 1\}\) : 1 si une machine est installée sur le site \(k \in \mathcal{K}\), 0 sinon.
    \item \(s_{jkt} \in \{0, 1\}\) : 1 si la tâche \(j \in \mathcal{J}\) commence sur le site \(k \in \mathcal{K}\) au début de la période \(t \in \mathcal{P}\), 0 sinon.
    \item \(T_{j} \in \mathcal{Z}\) : retard pour la tâche \(j \in \mathcal{J}\)
\end{itemize}

\subsubsection{Formulation mathématique}

\begin{align}
    \label{eq:time_objective} \min \quad \lambda_{1} \sum_{k \in \mathcal{K}} c_{k} x_{k} + \lambda_{2} \sum_{j \in \mathcal{J}} \sum_{k \in \mathcal{K}} \sum_{t \in \mathcal{P}} 2 e_{jk} s_{jkt} + \lambda_{3} \sum_{j \in \mathcal{J}} T_{j} \beta
\end{align}
\begin{align}
    \text{s.c.~}
    & \label{eq:time_installation} \sum_{k \in \mathcal{K}} x_{k} = |\mathcal{M}| \\
    & \label{eq:time_execution} \sum_{k \in \mathcal{K}} \sum_{t \in \mathcal{P}} s_{jkt} = 1 & \forall j \in \mathcal{J} \\
    & \label{eq:time_start} \sum_{t=1}^{r_{jk}} s_{jkt} = 0 & \forall j \in \mathcal{J}, \forall k \in \mathcal{K} \\
    & \label{eq:time_scheduling} s_{jkt} + \sum_{\tau=t}^{\min(t+p_{j}, |\mathcal{P}|)} s_{j'k\tau} \leq x_{k} & \forall k \in \mathcal{K}, \forall t \in \mathcal{P}, \forall j, j' \in \Omega_{k} \\
    & \label{eq:time_retards} T_{j} \geq \left( \sum_{k \in \mathcal{K}} \sum_{t \in \mathcal{P}} s_{jkt} (t + p_{j} + r_{jk}) \right) - d_{j} & \forall j \in \mathcal{J} \\
    & \label{eq:time_domain_installation} x_{k} \in \{0, 1\} & \forall k \in \mathcal{K} \\
    & \label{eq:time_domain_scheduling} s_{jkt} \in \{0, 1\} & \forall j \in \mathcal{J}, \forall k \in \mathcal{K}, \forall t \in \mathcal{P} \\
    & \label{eq:time_domain_retards} T_{j} \geq 0 & \forall j \in \mathcal{J}
\end{align}
